---
import { getCollection } from "astro:content";
import Layout from "~/layouts/Layout.astro";

const isDev = import.meta.env.DEV;

const docs = await getCollection("docs");
const sortedDocs = docs
    .filter((doc) => isDev || !doc.data.draft)
    .sort((a, b) => (a.data.order || 0) - (b.data.order || 0));
---

<Layout title="Documentation - @hectoday/http">
    <nav>
        <a href="/">‚Üê Home</a>
    </nav>

    <h1>Documentation</h1>

    <ul>
        {
            sortedDocs.map((doc) => (
                <li>
                    <a href={`/docs/${doc.id}`}>
                        {doc.data.title}
                        {doc.data.draft && (
                            <span class="draft-badge">[DRAFT]</span>
                        )}
                    </a>
                    {doc.data.description && <p>{doc.data.description}</p>}
                </li>
            ))
        }
    </ul>
</Layout>

<style>
    nav {
        margin-bottom: 2rem;
    }

    ul {
        list-style: none;
        padding: 0;
    }

    li {
        margin-bottom: 1.5rem;
    }

    li p {
        margin: 0.25rem 0 0 0;
        color: #666;
    }

    .draft-badge {
        margin-left: 0.5rem;
        font-size: 0.75rem;
        color: #ff6b6b;
        font-weight: bold;
    }
</style>
